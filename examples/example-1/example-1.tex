
% ##########################################################################################################
\documentclass[a5paper]{article}
\usepackage{lipsum}
\usepackage[columnwise]{lineno}
\usepackage{coffeexelatex}
\usepackage[top=10mm]{geometry}
% \usepackage[headheight=10mm]{geometry}


\renewcommand{\coffeexelatexroute}{../../lib/main}
% \newcommand{\noderun}[2]{\noderunscript{\coffeexelatexroute}{#1}{#2}}

% ##########################################################################################################
\begin{document}
% \linenumbers

\CX

\clearpage%\mbox{}\clearpage

\section{Introduction}
% \label{somelabel}
% \lipsum[1]

(1) The original technique to execute an arbitrary command:

\begin{verbatim}
\immediate\write18{node
  "\coffeexelatexroute"
  "\currfilepath"
  "helo"
  "readers (one)"
  > /tmp/temp.dat}\input{/tmp/temp.dat}
\end{verbatim}

(2) With ugly details largely hidden, the \verb#\exec{}# command is still fully general:

\begin{verbatim}
\exec{node
  "\coffeexelatexroute"
  "\currfilepath"
  "helo"
  "readers (two)"}
\end{verbatim}

(3) \verb#\noderunscript{}# will execute NodeJS code that adheres to the call convention established by
\CX:

\begin{verbatim}
\noderunscript
  {\coffeexelatexroute}
  {\currfilepath}
  {helo}
  {readers (three)}
\end{verbatim}

(4) Like the previous example, but with standard values assumed as shown above. This is the form that you
will want to use most of the time:

\begin{verbatim}
\noderun{helo}{readers (four)}
\end{verbatim}


{\textbf{Outputs:}}

\immediate\write18{node "\coffeexelatexroute" "\currfilepath" "helo" "readers (one)" > /tmp/temp.dat}\input{/tmp/temp.dat}

\exec{node "\coffeexelatexroute" "\currfilepath" "helo" "readers (two)"}

\noderunscript{\coffeexelatexroute}{\currfilepath}{helo}{readers (three)}

\noderun{helo}{readers (four)}

\clearpage
\section{Geometry}

% Write arbitrary text into the aux file:
\auxc{this line goes to the aux file}

% Write geometry data into the aux file:
\auxgeo

Use geometry data from aux file to render a table of layout dimensions into the document;
note the we could have used the \verb#\auxgeo# command anywhere in the document and that
this currently only works for documents with a single, constant layout.

Also note we're using a dash instead of an underscore hereâ€”in \TeX, underscores are special, so
we conveniently allow dashes to make things easier. The \CX\ command \verb#show-geometry# does
not take arguments, which is why the second pair of braces has been left empty:

{\textbf{Command:}}

\verb#\noderun{show-geometry}{}#\par

{\textbf{Output:}}

\noderun{show-geometry}{}

\clearpage
\section{Character Escaping}
The \CX\ command \verb#show-special-chrs# demonstrates that it is easy to include \TeX\ special characters
in the return value. The simple rule is that whenever the output of a command is meant to be understood
literally, it should be \verb#@escape#d:

{\textbf{Command:}}

\verb#\noderun{show-special-chrs}{}#

{\textbf{Output:}}

\noderun{show-special-chrs}{}




% \auxcs{ foo: \{ bar: 'baz' \} }

% \auxcs{
%   "page-nr":      \thepage,
%   jobname:        "\jobname"
%   }
% \auxcs{ "just a text" }

% x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x
% x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x
% x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x
% x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x
% \noderun{page-and-line-nr}{\thepage,\thelinenumber}

% \textbackslash{}pageref\{somelabel\}: \pageref{somelabel}

% \textbackslash{}ref\{somelabel\}: \ref{somelabel}

% Also see section \ref{otherlabel}, '\nameref{otherlabel}', on page \pageref{otherlabel}

% \noderun{escape}{\noexpand\currfilename}\currfilename

% \clearpage
% \section{References}
% \label{otherlabel}


% currfiledir: \currfiledir

% currfilebase: \currfilebase

% currfileext: \currfileext

% currfilename: \currfilename

% currfilepath: \currfilepath

% \jobname

% ##########################################################################################################
\end{document}
